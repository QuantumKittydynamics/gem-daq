{% extends "index.html" %}

{% block content %}

{% raw %}

<div>
    <h1>OptoHybrid monitoring and control</h1>
    <div class="row">
        <div class="col-md-12">
            <!-- System registers -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">System registers</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-4 control-label">VFAT2 mask</label>
                                    <div class="col-sm-8">   
                                        <div class="input-group">
                                            <div class="input-group-addon">0x</div>
                                            <input type="text" maxlength="6" class="form-control" ng-model="vfat2sMask">
                                        </div>
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label class="col-sm-4 control-label">VFAT2 trigger source</label>
                                    <div class="col-sm-8">   
                                        <select class="form-control" ng-model="t1Source" ng-options="item.name for item in t1SourceList track by item.id"></select>
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label class="col-sm-4 control-label">Loopback trigger source</label>
                                    <div class="col-sm-8">   
                                        <input type="text" maxlength="2" min="0" max="23" class="form-control" ng-model="loopbackSource">
                                    </div>
                                </div>  
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-4 control-label">Clock source</label>
                                    <div class="col-sm-8">   
                                        <select class="form-control" ng-model="clockSource" ng-options="item.name for item in clockSourceList track by item.id"></select>
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label class="col-sm-4 control-label">TDC SBit output</label>
                                    <div class="col-sm-8">   
                                        <input type="number" maxlength="6" min="0" max="23" class="form-control" ng-model="sbitSelect">
                                    </div>
                                </div>  
                            </div>
                        </div>
                    </div>
                    <a class="btn btn-success btn-xs" ng-click="set_system_regs()">Apply changes</a>
                </div>
            </div>            
        </div>
    </div>
    <div class="row">
        <div class="col-md-4">
            <!-- Wishbone counters -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Wishbone counters</h3>
                </div>
                <div class="panel-body">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Wishbone module</th>
                                <th>Strobes</th>
                                <th>Acknowledgments</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="counter in wbCounters" ng-class="{ danger: counter.stb != counter.ack }">
                                <td>{{ counter.name }}</td>
                                <td>{{ counter.stb | hex }}</td>
                                <td>{{ counter.ack | hex }}</td>
                            </tr>
                        </tbody>
                    </table>
                    <hr>
                    <p><a class="btn btn-primary btn-xs btn-block" ng-click="reset_wb_counters()">Reset the counters</a></p>
                </div>
            </div>           
        </div>             
        <div class="col-md-4">
            <!-- T1 counters -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">T1 commands counters</h3>
                </div>
                <div class="panel-body">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Command</th>
                                <th>Counter</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="counter in t1Counters">
                                <td>{{ counter.name }}</td>
                                <td>{{ counter.cnt | hex }}</td>
                            </tr>
                        </tbody>
                    </table>
                    <hr>
                    <p><a class="btn btn-primary btn-xs btn-block" ng-click="reset_t1_counters()">Reset the counters</a></p>
                </div>
            </div>           
        </div>       
        <div class="col-md-4">
            <!-- GTX counters -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">GTX error counters</h3>
                </div>
                <div class="panel-body">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Command</th>
                                <th>Counter</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="counter in gtxCounters">
                                <td>{{ counter.name }}</td>
                                <td>{{ counter.cnt | hex }}</td>
                            </tr>
                        </tbody>
                    </table>
                    <hr>
                    <p><a class="btn btn-primary btn-xs btn-block" ng-click="reset_gtx_counters()">Reset the counters</a></p>
                </div>
            </div>           
        </div>   
    </div>
</div>

{% endraw %}

{% endblock %}